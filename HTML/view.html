<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dish Details</title>
<style>
  body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:#fffaf0; margin:0; padding:40px;}
  h1 { text-align:center; color:#5a2a18; margin-bottom:20px;}
  table { width:80%; margin:auto; border-collapse:collapse; background:white; box-shadow:0 6px 14px rgba(0,0,0,0.1); border-radius:12px; overflow:hidden;}
  th, td { padding:15px; border-bottom:1px solid #ddd; text-align:left; vertical-align:top;}
  th { background:#f2d3c2; color:#5a2a18; width:200px;}
  td img { width:250px; height:180px; object-fit:cover; border-radius:10px;}
  ul { margin:0; padding:0; list-style:none;}
  ul li { background:#ffeaa7; display:inline-block; margin:5px; padding:6px 10px; border-radius:6px; font-size:14px;}
  .btns { text-align:center; margin-top:20px;}
  button { padding:10px 18px; border:none; border-radius:8px; cursor:pointer; margin:0 10px; font-size:15px; color:white;}
  .delete { background:#e74c3c;}
  .edit { background:#3498db;}
</style>
</head>
<body>

<h1>üç¥ Dish Details</h1>

<table id="dishTable"></table>

<div class="btns">
  <button class="delete" id="deleteBtn">Delete</button>
  <button class="edit" id="editBtn">Edit</button>
</div>

<script>
  // Get recipe index from URL
  const urlParams = new URLSearchParams(window.location.search);
  const index = urlParams.get("index");

  const recipes = JSON.parse(localStorage.getItem("formDataList")) || [];
  const recipe = recipes[index];

  if(recipe){
    const ingredientList = recipe.ingredients
      ? recipe.ingredients.split("\n").map(i=>i.trim()).filter(Boolean)
      : [];

    document.getElementById("dishTable").innerHTML = `
      <tr><th>Image</th><td><img src="${recipe.image}" alt="${recipe.name}"></td></tr>
      <tr><th>Name</th><td>${recipe.name}</td></tr>
      <tr><th>Category</th><td>${recipe.type || "N/A"}</td></tr>
      <tr><th>Ingredients</th><td><ul>${ingredientList.map(i=>`<li>${i}</li>`).join("")}</ul></td></tr>
      <tr><th>Description</th><td>${recipe.description || "No description"}</td></tr>
      <tr><th>Notes</th><td>${recipe.notes || "No notes"}</td></tr>
    `;

    // Delete recipe
    document.getElementById("deleteBtn").onclick = () => {
      if(confirm(`Delete "${recipe.name}"?`)){
        recipes.splice(index,1);
        localStorage.setItem("formDataList", JSON.stringify(recipes));
        alert("Recipe deleted!");
        window.location.href = "index1.html"; // back to menu
      }
    };

    // Edit recipe
    document.getElementById("editBtn").onclick = () => {
      localStorage.setItem("editDish", JSON.stringify(recipe));
      localStorage.setItem("editIndex", index); // save index for updating
      window.location.href = "form1.html";
    };

  } else {
    document.getElementById("dishTable").innerHTML = `<tr><td colspan="2">No recipe found.</td></tr>`;
  }
</script>

</body>
</html>
